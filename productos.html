<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Mediterranean productos</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>

.btn-movimientos {
  background: linear-gradient(90deg, #00c6ff, #0072ff);
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 10px;
  cursor: pointer;
  font-weight: bold;
  text-shadow: 0 0 8px rgba(255,255,255,0.6);
  box-shadow: 0 0 10px rgba(0,198,255,0.4);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.btn-movimientos::before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(120deg, transparent, rgba(255,255,255,0.4), transparent);
  transition: all 0.6s;
}

.btn-movimientos:hover::before {
  left: 100%;
}

.btn-movimientos:hover {
  transform: scale(1.08);
  box-shadow: 0 0 18px #00eaff, 0 0 30px #00eaff;
}





/* ===== Reset ===== */
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:Arial,sans-serif;
  display:flex;
  min-height:100vh;
  background:linear-gradient(135deg,#0d1117,#004e92,#00c6ff);
  background-size:300% 300%;
  animation:moverFondo 12s ease infinite;
  color:white;
  overflow-x:hidden;
}

/* ===== Sidebar ===== */
.sidebar{
  position:fixed;
  top:0;left:0;
  width:240px;height:100%;
  background:linear-gradient(135deg,#050d1c,#0a1f3d,#0e2a47,#122f68);
  background-size:400% 400%;
  animation:sidebarAnim 10s ease infinite;
  padding-top:40px;
  display:flex;flex-direction:column;gap:20px;
  z-index:1000;
  box-shadow:2px 0 25px rgba(0,0,0,0.8);
  overflow:hidden;
}
.sidebar::before{
  content:"";
  position:absolute;top:0;left:0;width:100%;height:100%;
  background:radial-gradient(circle,rgba(0,242,254,0.4) 1px,transparent 1px);
  background-size:40px 40px;
  animation:moverPuntos 6s linear infinite;
  opacity:0.6;
}
.sidebar::after{
  content:"";
  position:absolute;top:0;left:0;width:100%;height:100%;
  background:linear-gradient(transparent,rgba(0,242,254,0.1),transparent);
  animation:brillo 4s linear infinite;
}
.sidebar a{
  color:#00f2fe;
  text-decoration:none;
  padding:12px 20px;
  font-weight:bold;
  transition:all 0.3s ease;
  border-radius:8px;
  margin:0 15px;
  text-shadow:0 0 8px #00f2fe,0 0 15px #4facfe;
  display:flex;align-items:center;gap:10px;
  position:relative;z-index:2;
}
.sidebar a:hover,.sidebar a.active{
  background:rgba(255,255,255,0.1);
  color:#fff;
  transform:translateX(6px) scale(1.05);
  box-shadow:0 0 15px #00f2fe,inset 0 0 10px #00f2fe;
}

.copyright-fixed {
  position: fixed;
  bottom: 0;
  left: 240px; /* deja espacio del ancho del sidebar */
  width: calc(100% - 240px); /* ocupa todo menos el sidebar */
  text-align: center;
  background: linear-gradient(90deg, #004e92, #00c6ff);
  color: #ffffff;
  font-size: 13px;
  padding: 10px 0;
  font-family: "Poppins", Arial, sans-serif;
  box-shadow: 0 -2px 6px rgba(0, 0, 0, 0.25);
  z-index: 9999; /* por encima del sidebar */
  border-top-left-radius: 12px;
}

.copyright-fixed a {
  color: #caf0f8;
  text-decoration: none;
  font-weight: 500;
  margin-left: 5px;
  transition: color 0.3s, text-decoration 0.3s;
}

.copyright-fixed a:hover {
  color: #90e0ef;
  text-decoration: underline;
}

.policy-modal {
  display: none;
  position: fixed;
  z-index: 99999;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(4px);
  justify-content: center;
  align-items: center;
}
.policy-content {
  background: #ffffff;
  color: #000;
  padding: 25px;
  border-radius: 15px;
  width: 80%;
  max-width: 600px;
  box-shadow: 0 0 20px rgba(0,0,0,0.3);
  animation: fadeIn 0.3s ease;
}
.close-policy {
  float: right;
  font-size: 24px;
  cursor: pointer;
  color: #004e92;
  font-weight: bold;
}
.close-policy:hover { color: #00c6ff; }

.btn-actualizar {
  background: #00c6ff;
  color: white;
  border: none;
  padding: 6px 14px;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  margin-right: 6px;
}
.btn-actualizar:hover {
  background: #0099cc;
  transform: scale(1.1);
  box-shadow: 0 0 12px #00c6ff;
}




/* ===== Main ===== */
.main-content{
  margin-left:90px;
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:10px;
}
tr td, tr th {
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

tr:hover {
  background: rgba(0, 242, 254, 0.15);
  transition: 0.3s ease;
}

.alerta-stock {
  animation: parpadeo 1.2s infinite;
}

@keyframes parpadeo {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.6; }
}

#bgCanvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;}
.logo{margin-top:20px;animation:bounceIn 1.5s ease forwards;}
.logo img{width:150px;height:auto;box-shadow:0 0 25px rgba(0,242,254,0.7);transition:transform 0.3s ease,box-shadow 0.3s ease;}
.logo img:hover{transform:scale(1.05);box-shadow:0 0 40px rgba(0,242,254,1);}
h1{margin:15px 0 15px;text-shadow:0 0 15px rgba(0,0,0,0.6);animation:slideDown 1s ease-out;}

.main-content {
  margin-left: 240px; /* deja el ancho del sidebar */
  flex: 1;
  padding: 20px;
   overflow-y: auto; 
}

.container {
  width: 100%;           /* ocupa todo el ancho sin desbordar */
  max-width: 1250px;     /* mantiene tu l칤mite visual */
  margin: 0 auto;        /* centra el contenido */
}

.table-container {
  width: 100%;
  border-radius: 15px;
  margin-top: 10px;
  box-shadow: inset 0 0 10px rgba(0,0,0,0.3);
  overflow: visible !important; /* evita scroll interno */
  max-height: none !important;  /* permite que crezca seg칰n el contenido */
}

form{display:flex;flex-wrap:wrap;gap:12px;margin-bottom:10px;justify-content:space-between;}
form input,form textarea,form button{
  padding:12px;border:none;border-radius:10px;flex:1 1 calc(25% - 12px);outline:none;transition:all 0.3s ease;
}
form textarea{flex:1 1 100%;resize:none;}
form input,form textarea{background:rgba(255,255,255,0.8);color:black;}
form input:focus,form textarea:focus{transform:scale(1.05);box-shadow:0 0 10px #00f2fe;}
form button{
  background:linear-gradient(90deg,#00f2fe,#4facfe);
  color:white;font-weight:bold;cursor:pointer;flex:1 1 100%;
}
form button:hover{transform:scale(1.05);box-shadow:0 0 15px #00f2fe;}
.table-container{max-height:400px;overflow-y:auto;width:100%;border-radius:15px;margin-top:10px;box-shadow:inset 0 0 10px rgba(0,0,0,0.3);}
table{width:100%;border-collapse:collapse;background:rgba(255,255,255,0.08);}
th,td{padding:12px;text-align:center;}
thead th{position:sticky;top:0;background:rgba(0,0,0,0.6);color:#fff;z-index:2;}
tr:hover{background:rgba(255,255,255,0.1);}
img{width:80px;border-radius:12px;transition:transform 0.3s ease;}
img:hover{transform:scale(1.1) rotate(3deg);}
.btn-eliminar{background:crimson;color:white;border:none;padding:6px 14px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;}
.btn-eliminar:hover{background:darkred;transform:scale(1.1);box-shadow:0 0 12px red;}
.disponible{color:#00ff7f;font-weight:bold;text-shadow:0 0 8px #00ff7f;animation:pulse 1.5s infinite;}
.agotado{color:#ff4c4c;font-weight:bold;text-shadow:0 0 8px #ff4c4c;animation:blink 1s infinite;}
#searchInput{padding:10px;width:100%;border-radius:8px;border:none;margin-bottom:10px;color:black;}

/* ===== Animaciones ===== */
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes fadeInUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes slideDown{from{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse{0%,100%{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:0.8}}
@keyframes blink{0%,50%,100%{opacity:1}25%,75%{opacity:0}}
@keyframes bounceIn{0%{transform:scale(0.3);opacity:0}50%{transform:scale(1.1);opacity:1}70%{transform:scale(0.9)}100%{transform:scale(1)}}
@keyframes moverFondo{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
@keyframes sidebarAnim{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
@keyframes moverPuntos{from{background-position:0 0}to{background-position:40px 40px}}
@keyframes brillo{from{transform:translateY(-100%)}to{transform:translateY(100%)}}
</style>
</head>
<body>

<canvas id="bgCanvas"></canvas>

<footer class="copyright-fixed">
  춸 2025 Mediterranean Technologies  
  | <a href="#" id="openPolicy">Pol칤tica de Privacidad y Seguridad</a>
</footer>

<!-- Modal -->
<div id="policyModal" class="policy-modal">
  <div class="policy-content">
    <span class="close-policy">&times;</span>
    <h2>Pol칤tica de Privacidad y Seguridad</h2>
    <p>En Mediterranean Technologies, valoramos tu privacidad. Todos los datos son tratados conforme al RGPD y nuestras medidas de seguridad garantizan la integridad de la informaci칩n...</p>
    <p><a href="politica-completa.html">Leer pol칤tica completa</a></p>
  </div>
</div>


<div class="sidebar">
  <a href="mediterranean.php"><i class="fas fa-home"></i> Menu Principal</a>
  <a href="productos.html"><i class="fas fa-boxes"></i> Productos</a>
  <a href="sucursales.html"><i class="fas fa-store"></i> Sucursales</a>
  <a href="usuarios.html"><i class="fas fa-users"></i> Usuarios</a>
  <a href="reportes.html"><i class="fas fa-chart-bar"></i> Reportes</a>
  <a href="utilidades.html"><i class="fas fa-cogs"></i> Utilidades</a>
</div>


<div class="main-content">
  <div id="contenido"></div>
</div>

<script>
/* ===== Fondo part칤culas ===== */
const canvas=document.getElementById("bgCanvas");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;
let particles=[];

class Particle{
  constructor(){
    this.x=Math.random()*canvas.width;
    this.y=Math.random()*canvas.height;
    this.radius=Math.random()*2+1;
    this.speedX=(Math.random()-0.5)*1;
    this.speedY=(Math.random()-0.5)*1;
  }
  draw(){
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);
    ctx.fillStyle="rgba(255,255,255,0.7)";
    ctx.fill();
  }
  update(){
    this.x+=this.speedX;
    this.y+=this.speedY;
    if(this.x<0||this.x>canvas.width)this.speedX*=-1;
    if(this.y<0||this.y>canvas.height)this.speedY*=-1;
    this.draw();
  }
}

function initParticles(){
  particles=[];
  for(let i=0;i<120;i++){particles.push(new Particle());}
}
function connectParticles(){
  for(let a=0;a<particles.length;a++){
    for(let b=a;b<particles.length;b++){
      let dx=particles[a].x-particles[b].x;
      let dy=particles[a].y-particles[b].y;
      let dist=Math.sqrt(dx*dx+dy*dy);
      if(dist<120){
        ctx.beginPath();
        ctx.strokeStyle=`rgba(0,242,254,${1-dist/120})`;
        ctx.lineWidth=1;
        ctx.moveTo(particles[a].x,particles[a].y);
        ctx.lineTo(particles[b].x,particles[b].y);
        ctx.stroke();
      }
    }
  }
}
function animateParticles(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  particles.forEach(p=>p.update());
  connectParticles();
  requestAnimationFrame(animateParticles);
}
initParticles();
animateParticles();
window.addEventListener("resize",()=>{canvas.width=window.innerWidth;canvas.height=window.innerHeight;initParticles();});

/* ===== Secciones ===== */
const contenido=document.getElementById("contenido");

function cargarSeccion(seccion) {
  let html = "";

  switch (seccion) {

    case "mediterranean.php":
      html = `
        <div class="logo"><img src="images/LogoMediterranean1992.png" alt="logo"></div>
        <h1>Inventario de Productos</h1>
        <div class="container">
          <form id="addForm">
            <input type="text" id="nombre" name="nombre" placeholder="Nombre del producto" required>
            <input type="text" id="categoria" name="categoria" placeholder="Categor칤a" required>
            <input type="text" id="proveedor" name="proveedor" placeholder="Proveedor" required>
            <input type="number" id="precio_compra" name="precio_compra" placeholder="Precio compra ($)" required>
            <input type="number" id="precio_venta" name="precio_venta" placeholder="Precio venta ($)" required>
            <input type="number" id="stock" name="stock" placeholder="Stock actual" required>
            <input type="text" id="ubicacion" name="ubicacion" placeholder="Ubicaci칩n (Ej: A1-03)" required>
            <input type="file" id="img" name="img" accept="image/*" required>
            <textarea id="descripcion" name="descripcion" placeholder="Descripci칩n" required></textarea>
            <select id="estado" name="estado" required>
              <option value="Activo">Activo</option>
              <option value="Inactivo">Inactivo</option>
              <option value="Descontinuado">Descontinuado</option>
            </select>
            <button type="submit">Agregar Producto</button>
          </form>

          <input type="text" id="searchInput" placeholder="Buscar producto por nombre o c칩digo">
          <div id="alertaStock" style="display:none; background:#ff4c4c; color:white; padding:10px; text-align:center; border-radius:10px; margin-bottom:10px; font-weight:bold;">
            丘멆잺 Algunos productos est치n por debajo del stock m칤nimo
          </div>

          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Imagen</th>
                  <th>Nombre</th>
                  <th>Categor칤a</th>
                  <th>Proveedor</th>
                  <th>Precio Compra</th>
                  <th>Precio Venta</th>
                  <th>Margen</th>
                  <th>Stock</th>
                  <th>Ubicaci칩n</th>
                  <th>Descripci칩n</th>
                  <th>Estado</th>
                  <th>Movimiento</th>
                </tr>
              </thead>
              <tbody id="tabla-body"></tbody>
            </table>
          </div>
        </div>`;
      break;

    case "movimientos.html":
      // 游댳 Aqu칤 cargamos el archivo externo movimiento.html
      fetch("movimientos.html")
        .then(res => res.text())
        .then(data => contenido.innerHTML = data)
        .catch(err => {
          contenido.innerHTML = `<p style="color:red;">Error al cargar movimiento.html</p>`;
          console.error("Error al cargar movimiento.html:", err);
        });
      return; // salimos para no ejecutar el resto
  }

  contenido.innerHTML = html;

  if (seccion === "mediterranean.php") {
    iniciarInventario();
  }
}

/* ===== Inventario ===== */
let productos = [];

async function obtenerProductos() {
  const res = await fetch("productos.php?accion=listar");
  productos = await res.json();
  renderProductos();
}

async function agregarProducto(formData) {
  await fetch("productos.php?accion=agregar", { method: "POST", body: formData });
  await obtenerProductos();
}

async function eliminarProducto(id) {
  const formData = new FormData();
  formData.append("id", id);
  await fetch("productos.php?accion=eliminar", { method: "POST", body: formData });
  await obtenerProductos();
}

function iniciarInventario() {
  const tbody = document.getElementById("tabla-body");

  function renderProductos(lista = productos) {
  const tbody = document.getElementById("tabla-body");
  const alerta = document.getElementById("alertaStock");
  let alertaActiva = false;

  tbody.innerHTML = "";

  lista.forEach(p => {
    const margen = ((p.precio_venta - p.precio_compra) / p.precio_compra * 100).toFixed(1);
    const bajoStock = parseInt(p.stock) < parseInt(p.stock_minimo);

    if (bajoStock) alertaActiva = true;

    const tr = document.createElement("tr");
    tr.style.transition = "background 0.4s";
    if (bajoStock) tr.style.background = "rgba(255,0,0,0.2)";

    // === Contenido HTML de cada fila ===
    tr.innerHTML = `
      <td><img src="${p.img}" alt="${p.nombre}"></td>
      <td>${p.nombre}</td>
      <td>${p.categoria}</td>
      <td>${p.proveedor}</td>
      <td>$${p.precio_compra}</td>
      <td>$${p.precio_venta}</td>
      <td>${margen}%</td>
      <td>${p.stock}</td>
      <td>${p.ubicacion}</td>
      <td>${p.descripcion}</td>
      <td class="estado">
        ${
          p.estado === "Activo"
            ? "<span class='disponible'>Activo</span>"
            : p.estado === "Inactivo"
            ? "<span style='color:#ffb703;font-weight:bold;'>Inactivo</span>"
            : "<span style='color:#ff4c4c;font-weight:bold;'>Descontinuado</span>"
        }
      </td>
      <td>
      <button class="btn-movimientos" data-id="${p.id}">Movimientos</button>
      </td>
    `;

    // === Eventos de los botones por fila ===
    tr.addEventListener("click", e => {
      // 游댳 Bot칩n Movimientos
      if (e.target.closest(".btn-movimientos")) {
        const id = e.target.closest(".btn-movimientos").dataset.id;
        localStorage.setItem("productoSeleccionado", id);
        window.location.href = "movimientos.html";
        
      }
    });

    tbody.appendChild(tr);
  });

  // === Mostrar alerta si hay productos con bajo stock ===
  alerta.style.display = alertaActiva ? "block" : "none";
}


  // === Evento para agregar producto ===
  document.getElementById("addForm").addEventListener("submit", async e => {
    e.preventDefault();
    const formData = new FormData(e.target);
    await agregarProducto(formData);
    e.target.reset();
  });

  // === Buscador ===
  document.getElementById("searchInput").addEventListener("input", e => {
    const term = e.target.value.toLowerCase();
    const filtrados = productos.filter(
      p => p.nombre.toLowerCase().includes(term) || p.codigo.toLowerCase().includes(term)
    );
    renderProductos(filtrados);
  });

  window.renderProductos = renderProductos;
  obtenerProductos();
}


/* ===== Inicio ===== */
cargarSeccion("mediterranean.php");
</script>
<script>
document.getElementById("openPolicy").onclick = () => {
  document.getElementById("policyModal").style.display = "flex";
};
document.querySelector(".close-policy").onclick = () => {
  document.getElementById("policyModal").style.display = "none";
};
window.onclick = (e) => {
  if (e.target == document.getElementById("policyModal"))
    document.getElementById("policyModal").style.display = "none";
};
</script>

</body>
</html>