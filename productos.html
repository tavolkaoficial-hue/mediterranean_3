<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Mediterranean productos</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
/* ===== Reset ===== */
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:Arial,sans-serif;
  display:flex;
  min-height:100vh;
  background:linear-gradient(135deg,#0d1117,#004e92,#00c6ff);
  background-size:300% 300%;
  animation:moverFondo 12s ease infinite;
  color:white;
  overflow-x:hidden;
}

/* ===== Sidebar ===== */
.sidebar{
  position:fixed;
  top:0;left:0;
  width:240px;height:100%;
  background:linear-gradient(135deg,#050d1c,#0a1f3d,#0e2a47,#122f68);
  background-size:400% 400%;
  animation:sidebarAnim 10s ease infinite;
  padding-top:40px;
  display:flex;flex-direction:column;gap:20px;
  z-index:1000;
  box-shadow:2px 0 25px rgba(0,0,0,0.8);
  overflow:hidden;
}
.sidebar::before{
  content:"";
  position:absolute;top:0;left:0;width:100%;height:100%;
  background:radial-gradient(circle,rgba(0,242,254,0.4) 1px,transparent 1px);
  background-size:40px 40px;
  animation:moverPuntos 6s linear infinite;
  opacity:0.6;
}
.sidebar::after{
  content:"";
  position:absolute;top:0;left:0;width:100%;height:100%;
  background:linear-gradient(transparent,rgba(0,242,254,0.1),transparent);
  animation:brillo 4s linear infinite;
}
.sidebar a{
  color:#00f2fe;
  text-decoration:none;
  padding:12px 20px;
  font-weight:bold;
  transition:all 0.3s ease;
  border-radius:8px;
  margin:0 15px;
  text-shadow:0 0 8px #00f2fe,0 0 15px #4facfe;
  display:flex;align-items:center;gap:10px;
  position:relative;z-index:2;
}
.sidebar a:hover,.sidebar a.active{
  background:rgba(255,255,255,0.1);
  color:#fff;
  transform:translateX(6px) scale(1.05);
  box-shadow:0 0 15px #00f2fe,inset 0 0 10px #00f2fe;
}

/* ===== Main ===== */
.main-content{
  margin-left:240px;
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:10px;
}
#bgCanvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;}
.logo{margin-top:20px;animation:bounceIn 1.5s ease forwards;}
.logo img{width:150px;height:auto;box-shadow:0 0 25px rgba(0,242,254,0.7);transition:transform 0.3s ease,box-shadow 0.3s ease;}
.logo img:hover{transform:scale(1.05);box-shadow:0 0 40px rgba(0,242,254,1);}
h1{margin:15px 0 15px;text-shadow:0 0 15px rgba(0,0,0,0.6);animation:slideDown 1s ease-out;}
.container{
  width:90%;
  max-width:1100px;
  background:rgba(255,255,255,0.05);
  backdrop-filter:blur(12px);
  padding:25px;
  border-radius:20px;
  box-shadow:0 8px 25px rgba(0,0,0,0.4);
  animation:fadeInUp 1s ease;
}
form{display:flex;flex-wrap:wrap;gap:12px;margin-bottom:10px;justify-content:space-between;}
form input,form textarea,form button{
  padding:12px;border:none;border-radius:10px;flex:1 1 calc(25% - 12px);outline:none;transition:all 0.3s ease;
}
form textarea{flex:1 1 100%;resize:none;}
form input,form textarea{background:rgba(255,255,255,0.8);color:black;}
form input:focus,form textarea:focus{transform:scale(1.05);box-shadow:0 0 10px #00f2fe;}
form button{
  background:linear-gradient(90deg,#00f2fe,#4facfe);
  color:white;font-weight:bold;cursor:pointer;flex:1 1 100%;
}
form button:hover{transform:scale(1.05);box-shadow:0 0 15px #00f2fe;}
.table-container{max-height:400px;overflow-y:auto;width:100%;border-radius:15px;margin-top:10px;box-shadow:inset 0 0 10px rgba(0,0,0,0.3);}
table{width:100%;border-collapse:collapse;background:rgba(255,255,255,0.08);}
th,td{padding:12px;text-align:center;}
thead th{position:sticky;top:0;background:rgba(0,0,0,0.6);color:#fff;z-index:2;}
tr:hover{background:rgba(255,255,255,0.1);}
img{width:80px;border-radius:12px;transition:transform 0.3s ease;}
img:hover{transform:scale(1.1) rotate(3deg);}
.btn-eliminar{background:crimson;color:white;border:none;padding:6px 14px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;}
.btn-eliminar:hover{background:darkred;transform:scale(1.1);box-shadow:0 0 12px red;}
.disponible{color:#00ff7f;font-weight:bold;text-shadow:0 0 8px #00ff7f;animation:pulse 1.5s infinite;}
.agotado{color:#ff4c4c;font-weight:bold;text-shadow:0 0 8px #ff4c4c;animation:blink 1s infinite;}
#searchInput{padding:10px;width:100%;border-radius:8px;border:none;margin-bottom:10px;color:black;}

/* ===== Animaciones ===== */
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes fadeInUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes slideDown{from{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse{0%,100%{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:0.8}}
@keyframes blink{0%,50%,100%{opacity:1}25%,75%{opacity:0}}
@keyframes bounceIn{0%{transform:scale(0.3);opacity:0}50%{transform:scale(1.1);opacity:1}70%{transform:scale(0.9)}100%{transform:scale(1)}}
@keyframes moverFondo{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
@keyframes sidebarAnim{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
@keyframes moverPuntos{from{background-position:0 0}to{background-position:40px 40px}}
@keyframes brillo{from{transform:translateY(-100%)}to{transform:translateY(100%)}}
</style>
</head>
<body>

<canvas id="bgCanvas"></canvas>

<div class="sidebar">
  <a href="#" data-section="mediterranean.php" class="active"><i class="fas fa-house"></i> Menu Principal</a>
  <a href="#" data-section="sucursales"><i class="fas fa-building"></i> Sucursales</a>
  <a href="#" data-section="usuarios"><i class="fas fa-user"></i> Usuarios</a>
  <a href="#" data-section="reportes"><i class="fas fa-chart-line"></i> Reportes</a>
  <a href="#" data-section="utilidades"><i class="fas fa-gears"></i> Utilidades</a>
</div>

<div class="main-content">
  <div id="contenido"></div>
</div>

<script>
/* ===== Fondo partículas ===== */
const canvas=document.getElementById("bgCanvas");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=window.innerHeight;
let particles=[];

class Particle{
  constructor(){
    this.x=Math.random()*canvas.width;
    this.y=Math.random()*canvas.height;
    this.radius=Math.random()*2+1;
    this.speedX=(Math.random()-0.5)*1;
    this.speedY=(Math.random()-0.5)*1;
  }
  draw(){
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);
    ctx.fillStyle="rgba(255,255,255,0.7)";
    ctx.fill();
  }
  update(){
    this.x+=this.speedX;
    this.y+=this.speedY;
    if(this.x<0||this.x>canvas.width)this.speedX*=-1;
    if(this.y<0||this.y>canvas.height)this.speedY*=-1;
    this.draw();
  }
}

function initParticles(){
  particles=[];
  for(let i=0;i<120;i++){particles.push(new Particle());}
}
function connectParticles(){
  for(let a=0;a<particles.length;a++){
    for(let b=a;b<particles.length;b++){
      let dx=particles[a].x-particles[b].x;
      let dy=particles[a].y-particles[b].y;
      let dist=Math.sqrt(dx*dx+dy*dy);
      if(dist<120){
        ctx.beginPath();
        ctx.strokeStyle=`rgba(0,242,254,${1-dist/120})`;
        ctx.lineWidth=1;
        ctx.moveTo(particles[a].x,particles[a].y);
        ctx.lineTo(particles[b].x,particles[b].y);
        ctx.stroke();
      }
    }
  }
}
function animateParticles(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  particles.forEach(p=>p.update());
  connectParticles();
  requestAnimationFrame(animateParticles);
}
initParticles();
animateParticles();
window.addEventListener("resize",()=>{canvas.width=window.innerWidth;canvas.height=window.innerHeight;initParticles();});

/* ===== Secciones ===== */
const contenido=document.getElementById("contenido");

function cargarSeccion(seccion){
  let html="";
  switch(seccion){
    case "mediterranean.php":
      html=`<div class="logo"><img src="images/LogoMediterranean1992.png" alt="logo"></div>
      <h1>Bienvenido al Sistema</h1>
      <p style="text-align:center;">Selecciona una opción en el menú para comenzar.</p>
      <div class="container">
        <form id="addForm">
          <input type="file" id="img" name="img" accept="image/*" required>
          <input type="text" id="nombre" name="nombre" placeholder="Nombre del producto" required>
          <input type="number" id="precio" name="precio" placeholder="Precio ($)" required>
          <input type="number" id="stock" name="stock" placeholder="Stock" required>
          <textarea id="descripcion" name="descripcion" placeholder="Descripción" required></textarea>
          <button type="submit">Agregar Producto</button>
        </form>
        <input type="text" id="searchInput" placeholder="Buscar producto por nombre">
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Imagen</th>
                <th>Nombre</th>
                <th>Precio</th>
                <th>Stock</th>
                <th>Descripción</th>
                <th>Estado</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody id="tabla-body"></tbody>
          </table>
        </div>
      </div>`;
      break;
    case "sucursales": html="<h1>Sucursales</h1><p>Administración de sucursales próximamente aquí.</p>"; break;
    case "usuarios": html="<h1>Usuarios</h1><p>Gestión de usuarios próximamente aquí.</p>"; break;
    case "reportes": html="<h1>Reportes</h1><p>Generación de reportes próximamente aquí.</p>"; break;
    case "utilidades": html="<h1>Utilidades</h1><p>Herramientas y configuraciones próximamente aquí.</p>"; break;
  }
  contenido.innerHTML=html;
  if(seccion==="mediterranean.php"){iniciarInventario();}
}

/* ===== Eventos menú ===== */
document.querySelectorAll(".sidebar a").forEach(link=>{
  link.addEventListener("click",e=>{
    e.preventDefault();
    document.querySelectorAll(".sidebar a").forEach(a=>a.classList.remove("active"));
    link.classList.add("active");
    cargarSeccion(link.dataset.section);
  });
});

/* ===== Inventario ===== */
let productos=[];

async function obtenerProductos(){
  const res=await fetch("productos.php?accion=listar");
  productos=await res.json();
  renderProductos();
}

async function agregarProducto(formData){
  await fetch("productos.php?accion=agregar",{method:"POST",body:formData});
  await obtenerProductos();
}

async function eliminarProducto(id){
  const formData=new FormData();
  formData.append("id",id);
  await fetch("productos.php?accion=eliminar",{method:"POST",body:formData});
  await obtenerProductos();
}

async function actualizarStock(id,stock){
  const formData=new FormData();
  formData.append("id",id);
  formData.append("stock",stock);
  await fetch("productos.php?accion=actualizarStock",{method:"POST",body:formData});
  await obtenerProductos();
}

function iniciarInventario(){
  const tbody=document.getElementById("tabla-body");

  function renderProductos(lista=productos){
    tbody.innerHTML="";
    lista.forEach(p=>{
      const tr=document.createElement("tr");
      tr.innerHTML=`
        <td><img src="${p.img}" alt="${p.nombre}"></td>
        <td>${p.nombre}</td>
        <td>$${p.precio}</td>
        <td><input type="number" class="stock-input" value="${p.stock}" min="0" data-id="${p.id}"></td>
        <td>${p.descripcion}</td>
        <td class="estado">${p.stock>0?"<span class='disponible'>Disponible</span>":"<span class='agotado'>Agotado</span>"}</td>
        <td><button class="btn-eliminar" data-id="${p.id}">Eliminar</button></td>
      `;
      tbody.appendChild(tr);
    });

    document.querySelectorAll(".stock-input").forEach(input=>{
      input.addEventListener("change",async e=>{
        await actualizarStock(e.target.dataset.id,e.target.value);
      });
    });

    document.querySelectorAll(".btn-eliminar").forEach(btn=>{
      btn.addEventListener("click",async ()=>{
        await eliminarProducto(btn.dataset.id);
      });
    });
  }

  document.getElementById("addForm").addEventListener("submit",async e=>{
    e.preventDefault();
    const formData=new FormData(e.target);
    await agregarProducto(formData);
    e.target.reset();
  });

  document.getElementById("searchInput").addEventListener("input",e=>{
    const term=e.target.value.toLowerCase();
    const filtrados=productos.filter(p=>p.nombre.toLowerCase().includes(term));
    renderProductos(filtrados);
  });

  window.renderProductos=renderProductos;
  obtenerProductos();
}

/* ===== Inicio ===== */
cargarSeccion("mediterranean.php");
</script>
</body>
</html>